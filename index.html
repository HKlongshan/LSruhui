<!DOCTYPE html>
<html lang="zh-Hant">
<head>
  <meta charset="utf-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">
  <title>åƒ‘æ¸¯é †å¾·é¾å±±åŒé„‰æœƒ - å…¥æœƒç”³è«‹</title>
  <script src="https://cdn.jsdelivr.net/npm/signature_pad@4.0.0/dist/signature_pad.umd.min.js"></script>
  
  <style>
    /* åŸºç¤æ¨£å¼é‡ç½® */
    body { 
      background-color: #f4f1ee; 
      font-family: "PingFang TC", "Heiti TC", "Microsoft JhengHei", sans-serif; 
      padding: 40px 20px; 
      margin: 0; 
      color: #333;
    }

    /* ä¸»å®¹å™¨ */
    .container { 
      max-width: 850px; 
      margin: 0 auto; 
      background: #ffffff; 
      border-radius: 12px; 
      box-shadow: 0 10px 30px rgba(0,0,0,0.1); 
      overflow: hidden;
    }

    /* é ‚éƒ¨è£é£¾æ¢ */
    .top-bar {
      height: 10px;
      background: linear-gradient(90deg, #9b3d2a, #d93025);
    }

    /* æ©«å¹…åœ–ç‰‡ */
    #header-image { 
      width: 100%; 
      height: auto; 
      display: block;
    }

    /* æ¨™é¡Œå€å¡Š */
    .header-section {
      padding: 30px;
      text-align: center;
      background: #fff;
    }
    h2 { 
      color: #9b3d2a; 
      font-size: 32px; 
      margin: 10px 0; 
      letter-spacing: 2px;
    }

    /* æ„Ÿè¬ä¿¡å€å¡Š */
    .welcome-letter {
      margin: 0 30px 30px 30px;
      padding: 25px;
      background-color: #fff9f8;
      border-left: 5px solid #9b3d2a;
      line-height: 1.8;
      font-size: 17px;
      color: #555;
      text-align: justify;
    }

    /* å¿…å¡«æç¤º */
    .required-hint {
      text-align: center;
      color: #d93025;
      font-size: 15px;
      margin-bottom: 20px;
    }

    /* è¡¨å–®å€å¡Šåˆ†çµ„ */
    .form-section {
      padding: 30px;
      border-top: 1px solid #eee;
    }
    .section-title {
      font-size: 20px;
      font-weight: bold;
      color: #9b3d2a;
      margin-bottom: 20px;
      display: flex;
      align-items: center;
    }
    .section-title::before {
      content: "";
      display: inline-block;
      width: 4px;
      height: 20px;
      background: #9b3d2a;
      margin-right: 10px;
    }

    /* è¼¸å…¥æ¡†æ¨£å¼ */
    .form-group { margin-bottom: 25px; }
    label { 
      font-size: 17px; 
      display: block; 
      margin-bottom: 8px; 
      font-weight: 600;
      color: #444;
    }
    .required-label:after { content: " *"; color: #d93025; }
    
    input[type="text"], input[type="tel"], input[type="email"], input[type="number"] { 
      width: 100%; 
      padding: 12px 15px; 
      border: 1px solid #ccc; 
      border-radius: 6px;
      font-size: 16px; 
      box-sizing: border-box;
      transition: border 0.3s;
    }
    input:focus { border-color: #9b3d2a; outline: none; background-color: #fffdfd; }

    /* å–®é¸éˆ•ä½ˆå±€ */
    .radio-group { display: flex; gap: 20px; flex-wrap: wrap; margin-top: 5px; }
    .radio-option { display: flex; align-items: center; cursor: pointer; font-size: 16px; }
    .radio-option input { margin-right: 8px; width: 18px; height: 18px; accent-color: #9b3d2a; }

    /* å‡ºç”Ÿæ—¥æœŸå€å¡Š */
    .date-row { display: flex; gap: 15px; }
    .date-col { flex: 1; text-align: center; }
    .date-col input { text-align: center; }
    .date-label { font-size: 12px; color: #888; margin-top: 4px; }

    /* æœƒè²»èˆ‡è²æ˜å€å¡Š */
    .declaration-card {
      background-color: #fdfdfd;
      border: 1px solid #e0e0e0;
      border-radius: 8px;
      padding: 20px;
      margin-bottom: 30px;
    }
    .fee-highlight { 
      color: #d93025; 
      font-weight: bold; 
      font-size: 19px;
      display: block;
      margin-bottom: 5px;
    }
    .terms-text {
      font-size: 15px;
      line-height: 1.6;
      color: #666;
      margin-top: 15px;
    }

    /* ç°½åæ¿ */
    .signature-container {
      border: 1px solid #ccc;
      border-radius: 8px;
      background-color: #fff;
      position: relative;
      margin-top: 10px;
    }
    canvas { width: 100%; height: 200px; display: block; touch-action: none; cursor: crosshair; }
    .clear-btn { 
      background: none; border: none; color: #9b3d2a; 
      font-weight: bold; cursor: pointer; padding: 10px; 
      float: right; font-size: 14px;
    }

    /* æäº¤æŒ‰éˆ• */
    .submit-container {
      padding: 40px 30px;
      text-align: center;
      background-color: #f9f9f9;
    }
    .submit-btn { 
      width: 100%; 
      max-width: 350px; 
      padding: 16px; 
      background: linear-gradient(135deg, #9b3d2a 0%, #7a2d1f 100%);
      color: white; 
      border: none; 
      border-radius: 50px; 
      font-size: 20px; 
      font-weight: bold; 
      cursor: pointer; 
      box-shadow: 0 5px 15px rgba(155, 61, 42, 0.3);
      transition: transform 0.2s, box-shadow 0.2s;
    }
    .submit-btn:active { transform: scale(0.98); }
    .submit-btn:disabled { background: #ccc; box-shadow: none; cursor: not-allowed; }

    #msg { margin-top: 20px; font-weight: bold; }
  </style>
</head>
<body>

<div class="container">
  <div class="top-bar"></div>
  <img id="header-image" src="https://hklongshan.github.io/LSruhui/banner.jpg" alt="åƒ‘æ¸¯é †å¾·é¾å±±åŒé„‰æœƒ">
  
  <div class="header-section">
    <h2>åƒ‘æ¸¯é †å¾·é¾å±±åŒé„‰æœƒ</h2>
    <div class="welcome-letter">
      æ‰¿è’™æ‚¨çš„é—œæ³¨èˆ‡æ”¯æŒï¼Œå¯¦ä¹ƒæœ¬æœƒä¹‹å¹¸ã€‚è¬¹å‘æ‚¨è‡´ä»¥æœ€èª æ‘¯çš„æ„Ÿè¬ã€‚æ„Ÿè¬æ‚¨ä¸€ç›´ä»¥ä¾†å°åƒ‘æ¸¯é †å¾·é¾å±±åŒé„‰æœƒçš„å‘µè­·èˆ‡æ¨å‹•ï¼Œä¹Ÿç›¼èƒ½åœ¨æ‚¨çš„è¦‹è­‰ä¸‹ï¼Œé–‹å•Ÿèˆ‡åŒé„‰æ”œæ‰‹åŒè¡Œçš„æ–°ç¯‡ã€‚
    </div>
    <div class="required-hint">æ³¨æ„ï¼šæ¨™è¨» * çš„é …ç›®ç‚ºå¿…å¡«å…§å®¹</div>
  </div>

  <form id="memberForm">
    <input type="hidden" name="member_id" id="member_id_hidden">
    <input type="hidden" name="dob" id="dob_hidden">

    <div class="form-section">
      <div class="section-title">åŸºæœ¬è³‡æ–™</div>
      
      <div class="form-group">
        <label class="required-label">ä¸­æ–‡å§“å</label>
        <input type="text" name="name_ch" required placeholder="è«‹è¼¸å…¥ä¸­æ–‡å§“å">
      </div>

      <div class="form-group">
        <label class="required-label">è‹±æ–‡å§“å</label>
        <input type="text" name="name_en" required placeholder="ä¾‹å¦‚ï¼šCHAN TAI MAN">
      </div>

      <div class="form-group">
        <label class="required-label">æ€§åˆ¥</label>
        <div class="radio-group">
          <label class="radio-option"><input type="radio" name="gender" value="ç”·" required> ç”·</label>
          <label class="radio-option"><input type="radio" name="gender" value="å¥³"> å¥³</label>
        </div>
      </div>

      <div class="form-group">
        <label class="required-label">å‡ºç”Ÿæ—¥æœŸ</label>
        <div class="date-row">
          <div class="date-col">
            <input type="number" id="dob_y" placeholder="1980" min="1900" max="2026">
            <div class="date-label">å¹´ (YYYY)</div>
          </div>
          <div class="date-col">
            <input type="number" id="dob_m" placeholder="01" min="1" max="12">
            <div class="date-label">æœˆ (MM)</div>
          </div>
          <div class="date-col">
            <input type="number" id="dob_d" placeholder="01" min="1" max="31">
            <div class="date-label">æ—¥ (DD)</div>
          </div>
        </div>
      </div>

      <div class="form-group">
        <label class="required-label">èº«ä»½è­‰è™Ÿç¢¼ (å‰4ä½)</label>
        <input type="text" name="hkid_prefix" required placeholder="ä¾‹å¦‚ï¼šA123">
      </div>

      <div class="form-group">
        <label>ç±è²«</label>
        <input type="text" name="native_place" value="é †å¾·é¾å±±">
      </div>

      <div class="form-group">
        <label class="required-label">è·æ¥­</label>
        <input type="text" name="occupation" required placeholder="è«‹å¡«å¯«ç¾è·æˆ–é€€ä¼‘å‰è·æ¥­">
      </div>
    </div>

    <div class="form-section">
      <div class="section-title">è¯çµ¡è³‡è¨Š</div>
      
      <div class="form-group">
        <label class="required-label">æ‰‹æé›»è©±</label>
        <input type="tel" name="phone_mobile" required placeholder="ä¸»è¦è¯çµ¡é›»è©±">
      </div>

      <div class="form-group">
        <label>ä½å®…/è¾¦å…¬å®¤é›»è©±</label>
        <input type="tel" name="phone_home">
      </div>

      <div class="form-group">
        <label class="required-label">ä½å®…åœ°å€</label>
        <input type="text" name="address" required placeholder="è«‹å¡«å¯«å®Œæ•´éƒµå¯„åœ°å€">
      </div>

      <div class="form-group">
        <label>é›»éƒµåœ°å€</label>
        <input type="email" name="email" placeholder="example@email.com">
      </div>

      <div class="form-group">
        <label>æ¨è–¦äºº</label>
        <input type="text" name="referee" placeholder="è‹¥æœ‰æ¨è–¦äººè«‹å¡«å¯«">
      </div>
    </div>

    <div class="form-section">
      <div class="section-title">å…¥æœƒç¢ºèª</div>
      
      <div class="declaration-card">
        <span class="fee-highlight">æ°¸é å…¥æœƒæœƒè²»100æ¸¯å…ƒï¼Œ</span>
        <span class="fee-highlight">è«‹å‰å¾€ç§˜æ›¸è™•ç¹³ä»˜æœƒè²»æ¿€æ´»æœƒå“¡è³‡æ ¼ã€‚</span>
        
        <div class="terms-text">
          å¦‚ç²æ¥ç´ç‚ºåƒ‘æ¸¯é †å¾·é¾å±±åŒé„‰æœƒæœƒå“¡ï¼Œæœ¬äººé¡˜æ„æ¥å—åŠéµå®ˆè²´æœƒæœƒç« å’Œæ‰€é ’å¸ƒçš„ä¸€åˆ‡æ¢æ¬¾èˆ‡é€šå‘Šã€‚è‹¥æœ¬äººé€€å‡ºè²´æœƒï¼Œæœ¬äººé¡˜æ„äº¤é‚„æœƒå“¡è­‰æ›¸åŠå³æ™‚ç¹³é‚„ä¸€åˆ‡æ¬ ä»˜è²´æœƒä¹‹æœ‰é—œè²»ç”¨ã€‚
        </div>

        <div style="margin-top: 15px;">
          <label class="radio-option" style="font-weight: bold; color: #444;">
            <input type="checkbox" name="declaration" required style="width: 22px; height: 22px; margin-right: 10px; accent-color: #9b3d2a;"> 
            æœ¬äººåŒæ„ä»¥ä¸Šæ‰€æœ‰æ¢æ¬¾
          </label>
        </div>
      </div>

      <div class="form-group">
        <label class="required-label">ç”³è«‹äººç°½ç½² (è«‹åœ¨ä¸‹æ–¹ç©ºç™½è™•ç°½å)</label>
        <div class="signature-container">
          <canvas id="signature-pad"></canvas>
          <button type="button" class="clear-btn" onclick="clearSignature()">æ¸…é™¤ä¸¦é‡ç°½</button>
        </div>
        <input type="hidden" name="signature" id="signature">
      </div>
    </div>

    <div class="submit-container">
      <button type="button" id="submitBtn" class="submit-btn" onclick="submitForm()">ç¢ºèªæäº¤ç”³è«‹</button>
      <div id="msg"></div>
    </div>
  </form>
</div>

<script>
  // åˆå§‹åŒ–ç°½åæ¿
  const canvas = document.getElementById('signature-pad');
  const signaturePad = new SignaturePad(canvas, {
    penColor: 'rgb(0, 0, 0)'
  });

  function resizeCanvas() {
    const ratio = Math.max(window.devicePixelRatio || 1, 1);
    canvas.width = canvas.offsetWidth * ratio;
    canvas.height = canvas.offsetHeight * ratio;
    canvas.getContext("2d").scale(ratio, ratio);
    signaturePad.clear();
  }
  window.addEventListener("resize", resizeCanvas);
  resizeCanvas();

  function clearSignature() {
    signaturePad.clear();
  }

  async function submitForm() {
    const form = document.getElementById('memberForm');
    const msg = document.getElementById('msg');
    const btn = document.getElementById('submitBtn');

    // ç”Ÿæˆéš¨æ©Ÿæœƒå“¡ç·¨è™Ÿ
    const now = new Date();
    const dateStr = now.getFullYear() + String(now.getMonth()+1).padStart(2,'0') + String(now.getDate()).padStart(2,'0');
    const randomSuffix = Math.floor(1000 + Math.random() * 9000);
    const memberId = "LS" + dateStr + randomSuffix;
    document.getElementById('member_id_hidden').value = memberId;

    // é©—è­‰å‡ºç”Ÿæ—¥æœŸ
    const y = document.getElementById('dob_y').value;
    const m = document.getElementById('dob_m').value;
    const d = document.getElementById('dob_d').value;
    if(!y || !m || !d) { alert("è«‹å®Œæ•´å¡«å¯«å‡ºç”Ÿæ—¥æœŸ"); return; }
    document.getElementById('dob_hidden').value = `${y}-${m}-${d}`;

    // é©—è­‰ç°½å
    if(signaturePad.isEmpty()) { alert("è«‹åœ¨ç°½åå€ç°½ç½²"); return; }
    document.getElementById('signature').value = signaturePad.toDataURL();

    // åŸºç¤ HTML5 é©—è­‰
    if(!form.checkValidity()) {
      form.reportValidity();
      return;
    }

    btn.disabled = true;
    msg.style.color = "#666";
    msg.innerText = "è³‡æ–™å‚³è¼¸ä¸­ï¼Œè«‹å‹¿é—œé–‰é é¢...";

    const formData = new FormData(form);
    const data = Object.fromEntries(formData.entries());
    const webAppUrl = "https://script.google.com/macros/s/AKfycbzwYvy4t391KjK5CX8edd-pTCifijzXjoLFLzK8534JCl_SwrFrhqJD-a8zf-PEy_lM/exec";

    try {
        const blob = new Blob([JSON.stringify(data)], {type: 'text/plain'});
        await fetch(webAppUrl, {
            method: 'POST',
            body: blob,
            mode: 'no-cors'
        });
        
        // æˆåŠŸå¾Œçš„è™•ç†
        alert("æäº¤æˆåŠŸï¼\næ‚¨çš„è‡¨æ™‚æœƒå“¡ç·¨è™Ÿç‚ºï¼š" + memberId + "\nè«‹è¨˜ä¸‹ç·¨è™Ÿä¸¦å‰å¾€ç§˜æ›¸è™•ç¹³äº¤æœƒè²»ã€‚");
        msg.style.color = "green";
        msg.innerHTML = "ğŸ‰ ç”³è«‹å·²æäº¤æˆåŠŸï¼<br>è‡¨æ™‚ç·¨è™Ÿï¼š" + memberId;
        form.reset();
        signaturePad.clear();
    } catch (e) {
        msg.style.color = "red";
        msg.innerText = "æäº¤å‡ºéŒ¯ï¼Œè«‹æª¢æŸ¥ç¶²è·¯å¾Œé‡è©¦ã€‚";
        btn.disabled = false;
    }
  }
</script>

</body>
</html>
